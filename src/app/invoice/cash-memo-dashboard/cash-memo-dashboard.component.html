<p-toast></p-toast>
<div class="layout">
    <app-navbar></app-navbar>

    <div class="content-wrapper">
        <!-- <app-sidebar class="sidebar"></app-sidebar> -->
        <div class="sidebar bg-gray-400">
            <app-sidebar></app-sidebar>
        </div>

        <div class="main-content">
            <div class="raised-container">
                <div class="flex bg-gray-300 button-container">
                    <button type="button" pButton label="+ Create Cash Memo" (click)="CreateNewCashMemo()"
                        class="mt-3  text-lg mr-3 mb-3 p-button-raised bg-blue-500 text-white px-4 py-2.5 rounded-md hover:bg-blue-600 "></button>
                </div>
            </div>
            <div>
                <div class="padFlex flex gap-5">
                    <div class="col-4">
                        <p-panel class="left-panel">
                            <ng-template pTemplate="header">
                                <span class="p-panel-title" style="padding: 1px">All Cash Memos</span>
                            </ng-template>
                            <ng-template pTemplate="content">
                                <div class="left-panel-content">
                                    <br />
                                    <!-- <div class="left-panel-content"> -->
                                    <div *ngFor="let item of allCashMemo" class="order-list"
                                        [ngClass]="{ 'bg-gray-100': activeCM.id === item.id }">
                                        <div class="p-5 list-item" (click)="changeOrder(item)">
                                            <div class="text-base ml-3"><b>{{ item.cashMemoNumber }}</b></div>
                                            <div class="flex text-right" *ngIf="item.vendor">
                                                <div class=" font-italic text-base mt-2 mb-2 ml-3">
                                                    {{ item.vendor?.firstName }} {{ item.vendor?.lastName }}
                                                </div>
                                                <div class="col-6 text-base mt-2 mb-2">
                                                    <b>₹: </b>{{item.grossTotal}}
                                                </div>
                                            </div>
                                            <!-- <div class="flex" *ngIf="item.customer">
                                                <div class="font-italic text-base mt-2 mb-2 ml-3"
                                                    *ngIf="item.customer">
                                                    {{ item.customer?.displayName }}
                                                </div>
                                                <div class="col-6 text-base mt-2 mb-2 ">
                                                    <b>₹: </b>{{item.grossTotal}}
                                                </div>
                                            </div> -->
                                        </div>
                                    </div>
                                    <div class="text-center m-5" *ngIf="allCashMemo.length === 0">
                                        No Cash Memo Available
                                    </div>
                                </div>
                            </ng-template>
                            <p-footer> Total: {{ this.totalRecords}} </p-footer>
                        </p-panel>
                    </div>

                    <div class="col-7">
                        <p-panel>
                            <ng-template pTemplate="header">
                                <div class="w-full">
                                    <div class="grid m-0">
                                        <div class="col-6 p-0">
                                            <span class="p-panel-title">Cash Memo Details</span>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                            <div class="right-panel-content">
                                <div class="text-center m-5" *ngIf="!activeCM.id">
                                    <img src="assets/empty.svg" width="250" /><br />
                                    Select Cash Memo
                                </div>
                                <div *ngIf="activeCM.id">
                                    <!-- <h3 class="text-lg ">Purchase Order Details</h3>
                                    <br> -->
                                    <div class="flex">
                                        <div class="field col-11">
                                        </div>
                                        <div class="field col-1">
                                            <button pButton type="button" icon="pi pi-pencil" (click)="onEditCM(activeCM.id)"></button>
                                        </div>
                                    </div>
                                    <div class="flex">
                                        <div class="field col-4">
                                            <label class="mr-3 text-blue-500">Cash Memo Number:</label>
                                            <h5>#{{ this.activeCM.cashMemoNumber}}</h5>
                                        </div>
    
                                        <div class="field col-4">
                                            <label class="mr-3">Start on:</label>
                                            <h5>{{ this.activeCM.startDate | date : "short"}}</h5>
                                        </div>
    
                                        <div class="field col-4">
                                            <label class="mr-3">Due Date:</label>
                                            <h5>{{ this.activeCM.dueDate | date : "short"}}</h5>
                                        </div>
                                    </div>
    
                                    <div class="flex">
                                        <div class="field col-6">
                                            <label class="mr-3 text-blue-500">Request Status: </label>
                                            <h4>{{this.activeCM.requestStatus}} <br>
                                            </h4>
                                            <br>
                                        </div>
                                        <!-- <div class="field col-6" *ngIf="this.activeCN.creditToCustomer != null">
                                            <label class="mr-3 text-blue-500">Bill To</label>
                                            <h4>{{this.activeCN.creditToCustomer?.address?.billingName}} <br>
                                                {{this.activeCN.creditToCustomer?.address?.billingAddress}}<br>
                                                {{this.activeCN.creditToCustomer?.address?.city}},
                                                {{this.activeCN.creditToCustomer?.address?.pincode}}
                                            </h4>
                                            <br>
    
                                        </div>
                                        <div class="field col-6" *ngIf="this.activeCN.creditToVendor != null">
                                            <label class="mr-3 text-blue-500">Bill To</label>
                                            <h4>{{this.activeCN.creditToVendor?.address?.billingName}} <br>
                                                {{this.activeCN.creditToVendor?.address?.billingAddress}}<br>
                                                {{this.activeCN.creditToVendor?.address?.city}},
                                                {{this.activeCN.creditToVendor?.address?.pincode}}
                                            </h4>
                                            <br>
    
                                        </div> -->
                                    </div>
    
                                    <div>
                                        <p-table [value]="lineitems">
                                            <ng-template pTemplate="header">
                                                <tr>
                                                    <th>Item Detils</th>
                                                    <th>Price</th>
                                                    <th>Quantity</th>
                                                    <th>Discount</th>
                                                    <th>Total</th>
                                                </tr>
                                            </ng-template>
                                            <ng-template let-lineItem pTemplate="body">
                                                <tr>
                                                    <td>{{ lineItem.expenseName?.name }}</td>
                                                    <td>{{ lineItem.unitPrice }}</td>
                                                    <td>{{ lineItem.quantity }}</td>
                                                    <td>{{ lineItem.discount }}</td>
                                                    <td>{{ lineItem.amount }}</td>
                                                </tr>
                                            </ng-template>
                                        </p-table>
    
                                        <div class="flex mt-5">
                                            <div class="field col-6">
    
                                            </div>
                                            <div class="field col-6">
                                                <label class="mr-3">SubTotal:<b> {{this.cmSubTotal}}</b> </label>
    
                                                <hr>
                                                <label class="mr-3">Total:<b> {{this.cmSubTotal}}</b> </label>
                                            </div>
                                        </div>
                                    </div>
    
                                    <div class="flex">
                                        <div class="field col-6">
                                            <h4 class="text-blue-600">Description:</h4>
                                            <p>{{this.activeCM.decription}}</p>
                                        </div>
                                        <div class="field col-6">
                                            <h4 class="text-blue-600">Internal Notes:</h4>
                                            <p>{{this.activeCM.internalNotes}}</p>
                                        </div>
                                    </div>
    
                                </div>
                            </div>
                            <!-- <p-footer>
                            </p-footer> -->
                        </p-panel>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <p-blockUI [blocked]="submitted">
        <i class="pi pi-spin pi-spinner" style="font-size: 3rem"></i>
    </p-blockUI>
</div>