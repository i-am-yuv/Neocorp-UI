<p-toast></p-toast>
<div class="layout">
    <app-navbar></app-navbar>

    <div class="content-wrapper">
        <!-- <app-sidebar class="sidebar"></app-sidebar> -->
        <div class="sidebar bg-gray-400">
            <app-sidebar></app-sidebar>
        </div>

        <div class="main-content">
            <div class="raised-container">
                <div class="flex bg-gray-300 button-container">
                    <button type="button" pButton label="+ Create Return & Refund Order" (click)="CreateNewReturnRefund()"
                        class="mt-3  text-lg mr-3 mb-3 p-button-raised bg-blue-500 text-white px-4 py-2.5 rounded-md hover:bg-blue-600 "></button>
                </div>
            </div>

            <div>
                <div class="padFlex flex gap-5">

                    <div class="col-4">
                        <p-panel class="left-panel">
                            <ng-template pTemplate="header">
                                <span class="p-panel-title" style="padding: 1px">Return & Refund Orders</span>
                            </ng-template>
                            <ng-template pTemplate="content">
                                <div class="left-panel-content">
                                    <br />
                                    <!-- <div class="left-panel-content"> -->
                                    <div *ngFor="let item of allRROrder" class="order-list"
                                        [ngClass]="{ 'bg-gray-100': activeRR.id === item.id }">
                                        <div class=" list-item mt-3 mb-3" (click)="changeOrder(item)">
                                            <div class="text-base ml-3"><b># {{ item.documentNo }}</b></div>
                                            <div class="flex text-right">
                                                <div class=" font-italic text-base mt-2 mb-2 ml-3">
                                                    <b>Sales Order Number: </b>{{ item.salesOrder?.documentno != null ? item.salesOrder?.documentno : "NA" }}  
                                                    , <b>₹: </b>{{item.grossTotal != null ? item.grossTotal : 0}}
                                                </div>
                                                <!-- <div class="col-6 text-base mt-2 mb-2">
                                                    <b>₹: </b>{{item.grossTotal != null ? item.grossTotal : 0}}
                                                </div> -->
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-center m-5" *ngIf="allRROrder.length === 0">
                                        No Return & Refund Available
                                    </div>
                                </div>
                            </ng-template>
                            <p-footer> Total: {{ this.totalRecords}} </p-footer>
                        </p-panel>
                    </div>

                    <div class="col-7">
                        <p-panel>
                            <ng-template pTemplate="header">
                                <div class="w-full">
                                    <div class="grid m-0">
                                        <div class="col-6 p-0">
                                            <span class="p-panel-title">Return & Refund Order Details</span>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                            <div class="right-panel-content">
                                <div class="text-center m-5" *ngIf="!activeRR.id">
                                    <img src="assets/empty.svg" width="250" /><br />
                                    Select Return and Refund Order
                                </div>
                                <div *ngIf="activeRR.id">
                                    <!-- <h3 class="text-lg ">Purchase Order Details</h3>
                                    <br> -->
                                    <div class="flex">
                                        <div class="field col-11">
                                        </div>
                                        <div class="field col-1">
                                            <button pButton type="button" icon="pi pi-pencil" (click)="onEditRR(activeRR.id)"></button>
                                        </div>
                                    </div>
                                    <div class="flex">
                                        <div class="field col-6">
                                            <label class="mr-3 text-blue-500">Return & Refund Number:</label>
                                            <h5>#{{ this.activeRR.documentNo}}</h5>
                                        </div>
    
                                        <div class="field col-4">
                                            <label class="mr-3">Process on:</label>
                                            <h5>{{ this.activeRR.processDate | date : "short"}}</h5>
                                        </div>
                                    </div>
    
                                    <div class="flex">
                                        <div class="field col-6">
                                            <label class="mr-3 text-blue-500">Dispatch To</label>
                                            <h4>{{this.activeRR.salesOrder?.vendor?.address?.billingName}} <br>
                                                {{this.activeRR.salesOrder?.vendor?.address?.billingAddress}}<br>
                                                {{this.activeRR.salesOrder?.vendor?.address?.city}},
                                                {{this.activeRR.salesOrder?.vendor?.address?.pincode}}
                                            </h4>
                                            <br>
                                        </div>
                                        <!-- <div class="field col-6" *ngIf="this.activeCN.creditToCustomer != null">
                                            <label class="mr-3 text-blue-500">Bill To</label>
                                            <h4>{{this.activeCN.creditToCustomer?.address?.billingName}} <br>
                                                {{this.activeCN.creditToCustomer?.address?.billingAddress}}<br>
                                                {{this.activeCN.creditToCustomer?.address?.city}},
                                                {{this.activeCN.creditToCustomer?.address?.pincode}}
                                            </h4>
                                            <br>
    
                                        </div>
                                        <div class="field col-6" *ngIf="this.activeCN.creditToVendor != null">
                                            <label class="mr-3 text-blue-500">Bill To</label>
                                            <h4>{{this.activeCN.creditToVendor?.address?.billingName}} <br>
                                                {{this.activeCN.creditToVendor?.address?.billingAddress}}<br>
                                                {{this.activeCN.creditToVendor?.address?.city}},
                                                {{this.activeCN.creditToVendor?.address?.pincode}}
                                            </h4>
                                            <br>
    
                                        </div> -->
                                    </div>
    
                                    <div>
                                        <p-table [value]="lineitems">
                                            <ng-template pTemplate="header">
                                                <tr>
                                                    <th>Item Detils</th>
                                                    <th>Price</th>
                                                    <th>Quantity</th>
                                                    <th>Discount</th>
                                                    <th>Total</th>
                                                </tr>
                                            </ng-template>
                                            <ng-template let-lineItem pTemplate="body">
                                                <tr>
                                                    <td>{{ lineItem.expenseName?.name }}</td>
                                                    <td>{{ lineItem.unitPrice }}</td>
                                                    <td>{{ lineItem.quantity }}</td>
                                                    <td>{{ lineItem.discount }}</td>
                                                    <td>{{ lineItem.amount }}</td>
                                                </tr>
                                            </ng-template>
                                        </p-table>
    
                                        <div class="flex mt-5">
                                            <div class="field col-6">
    
                                            </div>
                                            <div class="field col-6">
                                                <label class="mr-3">SubTotal:<b> {{this.rrSubTotal}}</b> </label>
    
                                                <hr>
                                                <label class="mr-3">Total:<b> {{this.rrSubTotal}}</b> </label>
                                            </div>
                                        </div>
                                    </div>
    
                                    <div class="flex">
                                        <div class="field col-12">
                                            <label class="mr-3">Reason:</label>
                                            <h5>{{ this.activeRR.reason}}</h5>
                                        </div>
                                    </div>
    
                                </div>
                            </div>
                            <!-- <p-footer>
                            </p-footer> -->
                        </p-panel>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <p-blockUI [blocked]="submitted">
        <i class="pi pi-spin pi-spinner" style="font-size: 3rem"></i>
    </p-blockUI>
</div>