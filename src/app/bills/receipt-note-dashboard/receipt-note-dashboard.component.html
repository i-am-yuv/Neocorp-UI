<p-toast></p-toast>
<div class="">
    <div class="bg-white">
        <div class="border-bottom-1 border-200 text-right p-3">
            <button type="button" pButton label="+ Create Receipt Note" (click)="CreateNewReceiptNote()"
                class=" mr-3 bg-blue-700 text-white px-4 py-2.5 rounded-md hover:bg-blue-800  "></button>
        </div>
    </div>

    <div class="m-6 bg-white border-round-3xl">
        <div class="p-5">

            <div class="flex gap-4" style=" justify-content: center;">
            
                <div class="col-5">
                    <p-panel class="left-panel">
                        <ng-template pTemplate="header">
                            <span class="p-panel-title" style="padding: 1px">Receipt Notes</span>
                        </ng-template>
                        <ng-template pTemplate="content">
                            <div class="left-panel-content">
                                <br />
                                <!-- <div class="left-panel-content"> -->
                                <!-- <div *ngFor="let item of allReceiptNotes" class="order-list"
                                    [ngClass]="{ 'bg-gray-100': activeRN.id === item.id }">
                                    <div class="p-5 list-item" (click)="changeOrder(item)">
                                        <div class="text-base ml-3"><b>{{ item.receiptNoteNumber }}</b></div>
                                        <div class="flex text-right" *ngIf="item.vendor">
                                            <div class=" font-italic text-base mt-2 mb-2 ml-3">
                                                {{ item.vendor?.firstName }} {{ item.vendor?.lastName }}
                                            </div>
                                            <div class="col-6 text-base mt-2 mb-2">
                                                <b>₹: </b>{{item.grossTotal}}
                                            </div>
                                        </div>
                                        <div class="flex" *ngIf="item.customer">
                                            <div class="font-italic text-base mt-2 mb-2 ml-3" *ngIf="item.creditToCustomer">
                                                {{ item.customer?.displayName }}
                                            </div>
                                            <div class="col-6 text-base mt-2 mb-2 ">
                                                <b>₹: </b>{{item.grossTotal}}
                                            </div>
                                        </div>
                                    </div>
                                </div> -->

                                <div *ngFor="let item of allReceiptNotes" class="order-list"
                                    [ngClass]="{ 'bg-gray-100': activeRN.id === item.id }">
                                    <div class=" list-item" (click)="changeOrder(item)">
                                        <div class="flex w-full">
                                            <div class="col-2  justify-center align-center">
                                                <div class="person-icon">{{
                                                    item.vendor?.firstName.charAt(0) +
                                                    item.vendor?.lastName.charAt(0) }}</div>
                                            </div>
                                            <div class="col-10">
                                                <div class="text-base"><b>{{ item.receiptNoteNumber }}</b></div>
                                                <div class="flex gap-2 " *ngIf="item.vendor">
                                                    <div class="col-8 font-italic text-base">
                                                        {{ item.vendor?.firstName }} {{ item.vendor?.lastName }}
                                                    </div>
                                                    <div class="col-4   text-base text-right">
                                                        <b>₹: </b>{{item.grossTotal}}
                                                    </div>
                                                </div>
                                                <div class="flex gap-2" *ngIf="item.customer">
                                                    <div class="col-8 font-italic text-base ">
                                                        {{ item.customer?.displayName }}
                                                    </div>
                                                    <div class="col-4 text-base text-right ">
                                                        <b>₹: </b>{{item.grossTotal}}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div class="text-center m-5" *ngIf="allReceiptNotes.length === 0">
                                    No Receipt Notes Available
                                </div>
                            </div>
                        </ng-template>
                        <p-footer> Total: {{ this.totalRecords}} </p-footer>
                    </p-panel>
                </div>
    
                <div class="col-7">
                    <p-panel>
                        <ng-template pTemplate="header">
                            <div class="w-full">
                                <div class="grid m-0">
                                    <div class="col-6 p-0">
                                        <span class="p-panel-title">Receipt Note Details</span>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                        <div class="right-panel-content">
                            <div class="text-center m-5" *ngIf="!activeRN.id">
                                <img src="/assets/RN.png" width="400">
<!-- 
                                <img src="assets/empty.svg" width="250" /><br />
                                Select Receipt Note -->
                            </div>
                            <div *ngIf="activeRN.id">
                                
                                <div class="flex bg-gray-700 gap-3 rounded-div1 mr-3 p-2 ">
                                    <div class="field col-7  ml-3 ">
                                        <h4 class="text-gray-200">Payment Activity</h4>
                                        <h4 class="text-white">#{{this.activeRN.receiptNoteNumber}}
                                        </h4>

                                        <div class="flex gap-5 bg-white rounded-div1 mt-3 ">
                                            <div class="field col-6">
                                                <h5>Current Due</h5>
                                                <h4 class="remainAmount text-lg">₹ {{this.currentDue}}</h4>
                                            </div>
                                            <div class="field col-6">
                                                <h5>Total Amount</h5>
                                                <h4 class="text-lg">₹ {{this.activeRN.grossTotal}}</h4>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="field col-4 bg-gray-700">
                                        <div class=" bg-red-100 mt-2 ml-2 mr-2 rounded-div1">
                                            <h4 class="text-center text-red-400 text-base">Status:
                                                {{this.activeRN.status}}
                                            </h4>
                                        </div>
                                        <div>
                                            <div class="mt-5">
                                                <h5 class="text-white">Start Date: {{ this.activeRN.startDate |
                                                    date:'yyyy-MM-dd' }}</h5>
                                                <hr class="border-gray-200">
                                                <h5 class="text-white">Due Date: {{ this.activeRN.endDate |
                                                    date:'yyyy-MM-dd' }}</h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="flex">
                                    <div class="field col-11">
                                        <h4 class="text-blue-700">Receipt Note Details:</h4>
                                    </div>
                                    <div class="field col-1">
                                        <button pButton type="button" icon="pi pi-pencil"
                                            (click)="onEditRN(activeRN.id)"></button>
                                    </div>
                                </div>
                                <div class="flex">
                                    <div class="field col-4">
                                        <label class="mr-3 text-blue-500">Receipt Number:</label>
                                        <h5>#{{ this.activeRN.receiptNoteNumber}}</h5>
                                    </div>
    
                                    <div class="field col-4">
                                        <label class="mr-3 text-blue-500">Start on:</label>
                                        <h5>{{ this.activeRN.startDate |
                                            date:'yyyy-MM-dd' }}</h5>
                                    </div>
    
                                    <div class="field col-4">
                                        <label class="mr-3 text-blue-500">End Date:</label>
                                        <h5>{{ this.activeRN.endDate |
                                            date:'yyyy-MM-dd'}}</h5>
                                    </div>
                                </div>
    
                                <hr class="border-gray-200">
                                <div class="flex">
                                    <div class="field col-7">
                                        <!-- <h4 class="text-blue-500">Bill From</h4> <br>  -->
                                        <label class="mr-3 text-blue-500">Bill From:</label>
                                        <h5>{{this.activeRN.vendor?.address?.billingName}}</h5>
                                        <h5>{{this.activeRN.vendor?.address?.billingAddress}}</h5>
                                        <h5>{{this.activeRN.vendor?.address?.city}}
                                            ,{{this.activeRN.vendor?.address?.pincode}}</h5>
                                    </div>

                                    <div class="field col-4">
                                        <label class="mr-3 text-blue-500">Place of Supply</label>
                                        <h4>{{this.activeRN.placeOfSupply?.stateName}} <br>
                                        </h4>
                                        <br>
                                    </div>
                                </div>
    
                                <div>
                                    <p-table [value]="lineitems">
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <th>Item Detils</th>
                                                <th>Price</th>
                                                <th>Quantity</th>
                                                <th>Discount</th>
                                                <th>Total</th>
                                            </tr>
                                        </ng-template>
                                        <ng-template let-lineItem pTemplate="body">
                                            <tr>
                                                <td>{{ lineItem.expenseName?.name }}</td>
                                                <td>{{ lineItem.unitPrice }}</td>
                                                <td>{{ lineItem.quantity }}</td>
                                                <td>{{ lineItem.discount }}</td>
                                                <td>{{ lineItem.amount }}</td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
    
                                    <!-- <div class="flex mt-5">
                                        <div class="field col-6">
    
                                        </div>
                                        <div class="field col-6">
                                            <label class="mr-3">SubTotal:<b> {{this.rnSubTotal}}</b> </label>
    
                                            <hr>
                                            <label class="mr-3">Total:<b> {{this.rnSubTotal}}</b> </label>
                                        </div>
                                    </div> -->

                                    <div class=" border-200 text-right mr-6 mb-3 mt-3">
                                        <div class="text-lg">
                                            SUB TOTAL: ₹ {{this.rnSubTotal}}
                                        </div> <br>
                                        <div class="text-lg">
                                            TOTAL: ₹ {{this.rnSubTotal}}
                                        </div>
                                    </div>

                                </div>
    
                                

                                <div class="flex">
                                    <div class="field col-6">
                                        <h4 class="text-blue-500">Client Notes:</h4>
                                        <p>{{this.activeRN.clientNotes}}</p>
                                    </div>
                                </div>
    
                                <div class="flex">
                                    <div class="field col-6">
                                        <h4 class="text-blue-500">description:</h4>
                                        <p>{{this.activeRN.description}}</p>
                                    </div>
                                    <div class="field col-6">
                                        <h4 class="text-blue-500">Internal Notes:</h4>
                                        <p>{{this.activeRN.internalNotes}}</p>
                                    </div>
                                </div>
    
                            </div>
                        </div>
                    </p-panel>
                </div>
            </div>
            
        </div>
    </div>
</div>

<p-blockUI [blocked]="submitted">
    <i class="pi pi-spin pi-spinner" style="font-size: 3rem"></i>
</p-blockUI>